{%- include snippets/get-sources.html -%}
{%- assign _sources = __return -%}

<!-- {%- include snippets/assign.html target=site.data.variables.default.mathjax_autoNumber
  source0=site.mathjax_autoNumber source1=page.mathjax_autoNumber -%}
{%- assign _mathjax_autoNumber = __return -%} -->

<script>
MathJax = {
  //
  //  Load only TeX input and the contextual menu
  //
  loader: {load: ['input/tex', 'output/svg']},
  //
  //  When page is ready, render the math in the document
  //
  //
  //  When page is ready:
  //    disable the assistive-mathml menu item
  //    render the document, handling require and autoload calls
  //
  startup: {
    pageReady() {
      MathJax._.mathjax.mathjax.handleRetriesFor(() => MathJax.startup.document.render());
    }
  },
  //
  //  Override the usual typeset render action with one that generates MathML output
  //
  options: {
    renderActions: {
      assistiveMml: [],  // disable assistive mathml
      typeset: [150,
        (doc) => {for (math of doc.math) {MathJax.config.renderSVG(math, doc)}},
        (math, doc) => MathJax.config.renderSVG(math, doc)
      ]
    },
    menuOptions: {
      settings: {
        assistiveMml: false
      }
    }
  },
  //
  // The action to use for rendering MathML
  //
  renderSVG(math, doc) {
    math.typesetRoot = MathJax.tex2svg(math.root);
    math.display && math.typesetRoot.setAttribute('display', 'block');
  }
};
</script>
<script async src="{{ _sources.mathjax }}"></script>
